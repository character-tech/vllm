FROM us-central1-docker.pkg.dev/character-ai/vllm/vllm-forked:d0ab76f as builder
COPY . /mnt/vllm

# Install without build isolation to preserve existing binaries
RUN pip install --no-build-isolation --no-deps /mnt/vllm --force-reinstall

RUN rm -rf /mnt/vllm
RUN python3 -c "import vllm; print('Custom vLLM loaded successfully')"

ENV HF_HOME=/huggingface/cache
